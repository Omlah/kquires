{% load static %}
{% load i18n %}
<div class="row">
    <div class="custom-table">
        <table class="table text-center">
            <thead>
                <tr>
                    <th scope="col">{% trans "Number" %}</th>
                    <th scope="col">{% trans "Name" %}</th>
                    <th scope="col">{% trans "Employee Number" %}</th>
                    <th scope="col">{% trans "Department" %}</th>
                    <th scope="col">{% trans "Permission" %}</th>
                    <th scope="col">{% trans "Status" %}</th>
                    <th scope="col">{% trans "Date Added" %}</th>
                    <th scope="col">{% trans "Action" %}</th>
                </tr>
            </thead>
            <tbody>
              <!-- Example of dynamic rows -->
              {% for user in users %}
                <tr>
                    <td>{{user.id}}</td>
                    <td>{{user.name}}</td>
                    <td>{{user.employee_id}}</td>
                    <td>{{user.department.name}}</td>
                    <td>{% trans user.role %}</td>
                    <td>
                        {% if user.status == 'True' %}
                        <span>{% trans "Active" %}</span>
                        {% else %}
                        <span>{% trans "Inactive" %}</span>
                        {% endif %}
                    </td>
                    <td>{{user.created_at}}</td>
                    <td>
                      <div class="d-flex align-items-center justify-content-center">
                          <a href="javascript:void(0);" class="btn btn-primary d-flex align-items-center me-2" onclick="fetchUserDetails({{ user.id }})">
                              <img src="{% static 'images/edit.svg' %}" alt="{% trans 'Edit' %}" >
                              {% trans "Edit" %}
                          </a>

                          {% if request.user.is_admin %}
                             <a href="javascript:void(0);"
                                data-id="{{ user.id }}"
                                data-bs-toggle="modal"
                                data-bs-target="#deleteUserConfirmationModal"
                                class="text-danger d-flex align-items-center"
                                onclick="setDeleteUserFormAction({{ user.id }})">
                                <img src="{% static 'images/delete.svg' %}" alt="{% trans 'Delete' %}">
                            </a>
                            {% endif %}

                      </div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
        </table>
        <div class="d-flex justify-content-start align-items-center mb-3">
          <label for="limit-select" class="form-label me-2">{% trans "Items per page" %}:</label>
          <select id="limit-select" class="form-select w-auto" onchange="changeLimit()">
              <option value="10" {% if request.GET.page_size == "10" %}selected{% endif %}>10</option>
              <option value="20" {% if request.GET.page_size == "20" %}selected{% endif %}>20</option>
              <option value="50" {% if request.GET.page_size == "50" %}selected{% endif %}>50</option>
              <option value="100" {% if request.GET.page_size == "100" %}selected{% endif %}>100</option>
          </select>
      </div>
    </div>
         <!-- Pagination Controls -->
         <nav aria-label="Page navigation">
          <ul class="pagination d-flex justify-content-center">
              {% if page_obj.has_previous %}
                  <li class="page-item">
                      <a class="page-link" href="?page=1" aria-label="{% trans 'First' %}">
                          <span aria-hidden="true">&laquo;</span>
                      </a>
                  </li>
                  <li class="page-item">
                      <a class="page-link" href="?page={{ page_obj.previous_page_number }}">{% trans "Previous" %}</a>
                  </li>
              {% else %}
                  <li class="page-item disabled">
                      <span class="page-link">&laquo;</span>
                  </li>
              {% endif %}

              {% for page_num in page_obj.paginator.page_range %}
                  {% if page_num == page_obj.number %}
                      <li class="page-item active">
                          <span class="page-link">{{ page_num }}</span>
                      </li>
                  {% else %}
                      <li class="page-item">
                          <a class="page-link" href="?page={{ page_num }}">{{ page_num }}</a>
                      </li>
                  {% endif %}
              {% endfor %}

              {% if page_obj.has_next %}
                  <li class="page-item">
                      <a class="page-link" href="?page={{ page_obj.next_page_number }}">{% trans "Next" %}</a>
                  </li>
                  <li class="page-item">
                      <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}" aria-label="{% trans 'Last' %}">
                          <span aria-hidden="true">&raquo;</span>
                      </a>
                  </li>
              {% else %}
                  <li class="page-item disabled">
                      <span class="page-link">&raquo;</span>
                  </li>
              {% endif %}
          </ul>
      </nav>
    </div>
</div>
<script>
  function changeLimit() {
      var limit = document.getElementById('limit-select').value;
      var currentUrl = window.location.href.split('?')[0]; // Get base URL
      window.location.href = currentUrl + '?page_size=' + limit; // Redirect with page_size query param
  }

  function setDeleteUserFormAction(userId) {
    const form = document.getElementById('deleteUserForm');
    form.action = `/users/delete/${userId}/`;  // Update this to your actual delete URL
  }
</script>

  