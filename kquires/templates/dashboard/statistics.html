{% extends "pages/layout/sidebar.html" %}
{% load static %}
{% load i18n %}
{% block title %}
      kquires | {% trans 'Statistics' %}
    {% endblock title %}
{% block content %}

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<style>

</style>
<div class="container-fluid p-4"> 
    
        <!-- Top Section -->
        <div class="d-flex align-items-center justify-content-between bg-light p-3 mb-4">
            <!-- Left: Statistics -->
            <div class="text-start" style="font-size: 20px; color: black; font-weight: bold; cursor: pointer;">
                {% trans "Statistics" %}
            </div>

              
            <!-- Right: Button and Images -->
            <div class="d-flex align-items-center">
                <button class="btn  btn-sm d-flex align-items-center fs-6 me-2 border" style="color: black;  ">
                    <img src="{% static 'images/calender.svg' %}" alt="Add Icon" class="me-2">
                    {% trans "Last 7 Days" %}
                </button>
                <img src="{% static 'images/export.svg' %}" alt="Export Icon" class="ms-2">
            </div>
        </div>


        <style>
          .card-title{
            color: #A94BEA;
          }
        </style>
         <!-- General Over -->
        <div class="d-flex align-items-center justify-content-start p-3 mb-0 ">
      
      </div>
        <div class="container-fluid p-4">
          <div class="row p-3 mb-2">
           
            <div class="col-md-3 mt-3">
            <div class="card">
                <div class="card-body row d-flex justify-content-between align-items-center">
                    <!-- Left: Text -->
                    <div class="col-md-9">
                      <p class="card-text">{% trans "Total Articles" %}</p>
                      <h5 class="card-title">{{ total_articles }}</h5>
                      
                    </div>
                    
                    <!-- Right: Icon -->
                    <div class="col-md-3">
                        <img width="50" src="{% static 'images/total_article.svg' %}" alt="Icon" >
                    </div>
                </div>
            </div>
            </div>
            
            
            <div class="col-md-3 mt-3">
            <div class="card">
                <div class="card-body row d-flex justify-content-between align-items-center">
                    <!-- Left: Text -->
                    <div class="col-md-9">
                      <p class="card-text">{% trans "Total Users" %}</p>
                      <h5 class="card-title">{{ total_users }}</h5>
                      
                    </div>
                    
                    <!-- Right: Icon -->
                    <div class="col-md-3">
                        <img width="50" src="{% static 'images/feedback_article.svg' %}" alt="Icon" >
                    </div>
                </div>
            </div>
            </div>
            
            <div class="col-md-3 mt-3">
            <div class="card">
                <div class="card-body row d-flex justify-content-between align-items-center">
                    <!-- Left: Text -->
                    <div class="col-md-9">
                      <p class="card-text">{% trans "Rejected Articles" %}</p>
                      <h5 class="card-title">{{ rejected_articles }}</h5>
                      
                    </div>
                    
                    <!-- Right: Icon -->
                    <div class="col-md-3">
                        <img width="50" src="{% static 'images/published_article.svg' %}" alt="Icon" >
                    </div>
                </div>
            </div>
            </div>
            
            <div class="col-md-3 mt-3">
            <div class="card">
                <div class="card-body row d-flex justify-content-between align-items-center">
                    <!-- Left: Text -->
                    <div class="col-md-9">
                      <p class="card-text">{% trans "Total Contributors" %}</p>
                      <h5 class="card-title">{{ total_contributors }}</h5>
                      
                    </div>
                    
                    <!-- Right: Icon -->
                    <div class="col-md-3">
                        <img width="50" src="{% static 'images/pending_review.svg' %}" alt="Icon" >
                    </div>
                </div>
            </div>
            </div>
            
        </div>


        <div class="align-items-center justify-content-between" style="background-color: #ADB8F0; padding: 20px; border-radius: 10px; width: 100%;  margin-bottom: 30px">
          <!-- Header: Most Shared Articles -->
          <div style="font-size: 20px; font-weight: bold; color: black; text-align: left; margin-bottom: 20px;">
            
            {% trans "Most Shared Articles" %}
          </div>
          
      
          <!-- Table Section -->
          <div style="overflow-x: auto; background-color: white;">
              <table class="table text-center custom-table border:none;" >
                  <thead>
                      <tr>
                          <th style="padding: 10px; background-color: #ADB8F0;">Article Title</th>
                          <th style="padding: 10px; background-color: #ADB8F0;">Category</th>
                          <th style="padding: 10px;background-color: #ADB8F0;" >Number of Views</th>
                          <th style="padding: 10px; background-color: #ADB8F0;">Action</th>
                      </tr>
                  </thead>
                  <tbody >
                      <tr>
                          <td>Activation </td>
                          <td>Technical</td>
                          <td>2</td>
                          <td>Edit</td>
                      </tr>
                      <tr>
                          <td>Technical Support</td>
                          <td>Content</td>
                          <td>1</td>
                          <td>Edit</td>
                      </tr>
                      <tr>
                          <td>File Upload</td>
                          <td>Maintenance</td>
                          <td>3</td>
                          <td>Edit</td>
                      </tr>
                      <tr>
                          <td>New User Registration</td>
                          <td>Processes</td>
                          <td>4</td>
                          <td>Edit</td>
                      </tr>
                  </tbody>
              </table>
          </div>
          
          
      </div>
        
    
      <div class="align-items-center justify-content-between" style="background-color: #ADB8F0; padding: 20px; border-radius: 10px; width: 100%;  margin-bottom: 30px">
        
        
        
        <!-- Header: New Articles Added (Weekly/Monthly) -->
        <div style="font-size: 20px; font-weight: bold; color: black; text-align: left; margin-bottom: 20px;">
         {%trans 'New Articles Added (Weekly/Monthly)'%} 
        </div>
        
    
        <!-- Table Section -->
      <div style="overflow-x: auto; background-color: white;">
        <table class="table text-center custom-table border:none;">
            <thead>
                <tr>
                    <th style="padding: 10px; background-color: #ADB8F0;">Article Title</th>
                    <th style="padding: 10px; background-color: #ADB8F0;">Category</th>
                    <th style="padding: 10px;background-color: #ADB8F0;">Number of Views</th>
                </tr>
            </thead>
            <tbody>
                {% for article in new_articles %}
                    <tr>
                        <td style="padding: 10px;">{{ article.title }}</td>
                        <td style="padding: 10px;">{{ article.category.name }}</td> <!-- Assuming category has a 'name' field -->
                        <td style="padding: 10px;">{{ article.views }}</td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="3" style="padding: 10px;">No new articles available.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
      </div>

        
        
    </div>


  

    <!-- Middle Section -->
     
<div class="align-items-center justify-content-between " style="background-color: #ADB8F0; padding: 20px; border-radius: 10px; width: 100%;">
    <!-- Header: Most Visited Articles -->
    <div style="font-size: 20px; font-weight: bold; color: black; text-align: left; margin-bottom: 20px;">
      {%trans 'Most Visited Articles'%} 
    </div>
    

    <!-- Table Section -->
    <div style="overflow-x: auto; background-color: white;">
        <table class="table text-center custom-table border:none;" >
            <thead>
                <tr>
                    <th style="padding: 10px; background-color: #ADB8F0;">Article Title</th>
                    <th style="padding: 10px; background-color: #ADB8F0;">Category</th>
                    <th style="padding: 10px;background-color: #ADB8F0;" >Number of Views</th>
                    <th style="padding: 10px; background-color: #ADB8F0;">Action</th>
                </tr>
            </thead>
            <tbody >
                <tr>
                    <td>Activation </td>
                    <td>Technical</td>
                    <td>2</td>
                    <td>Edit</td>
                </tr>
                <tr>
                    <td>Technical Support</td>
                    <td>Content</td>
                    <td>1</td>
                    <td>Edit</td>
                </tr>
                <tr>
                    <td>File Upload</td>
                    <td>Maintenance</td>
                    <td>3</td>
                    <td>Edit</td>
                </tr>
                <tr>
                    <td>New User Registration</td>
                    <td>Processes</td>
                    <td>4</td>
                    <td>Edit</td>
                </tr>
            </tbody>
        </table>
    </div>
    
    
</div>

    <!-- Bottom Section
   <div class="row mb-4 mt-4">
    <div class="col-md-4 chart-container">
        <div class="card shadow-sm h-100">
          <div class="card-header bg-white text-black">
            <h5 class="mb-0">Support Tickets</h5>
          </div>
          <div class="card-body">
            <div id="support-tickets-chart"></div>
          </div>
        </div>
      </div> -->

      <!-- Users Card
      <div class="col-md-4 chart-container">
        <div class="card shadow-sm h-100">
          <div class="card-header bg-white text-black">
            <h5 class="mb-0">Users</h5>
          </div>
          <div class="card-body">
            <div id="users-chart"></div>
          </div>
        </div>
      </div> -->

      <!-- Distribution Card
      <div class="col-md-4 chart-container">
        <div class="card shadow-sm h-100">
          <div class="card-header bg-white text-black">
            <h5 class="mb-0">Distribution</h5>
          </div>
          <div class="card-body">
            <div id="distribution-chart"></div>
          </div>
        </div>
      </div> -->

    </div>
    <!-- Last Section -->
   

    <div class="d-flex flex-row mb-4 gap-3" style=" border-radius: 10px;">
        <!-- Search Articles Table -->
        <div class="d-flex flex-column align-items-center justify-content-between" 
             style="background-color: #ADB8F0; padding: 20px; border-radius: 10px; flex: 2;">
            <div style="font-size: 20px; font-weight: bold; color: black; text-align: center; margin-bottom: 20px;">
               {%trans 'Search Articles'%}
            </div>
            <table class="table text-center custom-table">
                <thead>
                    <tr>
                        <th style="padding: 10px; background-color: #ADB8F0;">#</th>
                        <th style="padding: 10px; background-color: #ADB8F0;">Keyword</th>
                        <th style="padding: 10px;background-color: #ADB8F0;">Number of Searches</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="border: none;">
                        <td style="border: none;">1</td>
                        <td style="border: none;">Technology</td>
                        <td style="border: none;">2</td>
                    </tr>
                    <tr style="background-color: #F2F2F2; border: none;">
                        <td style="border: none;">2</td>
                        <td style="border: none;">Content</td>
                        <td style="border: none;">1</td>
                    </tr>
                    <tr style="border: none;">
                        <td style="border: none;">3</td>
                        <td style="border: none;">File Upload</td>
                        <td style="border: none;">3</td>
                    </tr>
                    <tr style="background-color: #F2F2F2; border: none;">
                        <td style="border: none;">4</td>
                        <td style="border: none;">New User Registration</td>
                        <td style="border: none;">4</td>
                    </tr>
                </tbody>
            </table>
        </div>
    
        <!-- Most Visited Articles Table -->
        <div class="d-flex flex-column align-items-center justify-content-between" 
             style="background-color: #ADB8F0; padding: 20px; border-radius: 10px; flex: 2;">
            <div style="font-size: 20px; font-weight: bold; color: black; text-align: left; margin-bottom: 20px;">
              {%trans 'Most Visited Articles'%}
            </div>
            <table class="table text-center custom-table">
                <thead>
                    <tr>
                        <th style="padding: 10px; background-color: #ADB8F0;">#</th>
                        <th style="padding: 10px; background-color: #ADB8F0;">Employee Name</th>
                        <th style="padding: 10px;background-color: #ADB8F0;">Number of Articles Written</th>
                        <th style="padding: 10px;background-color: #ADB8F0;">Number of Articles Activated</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="border: none;">
                        <td style="border: none;">1</td>
                        <td style="border: none;">Operations</td>
                        <td style="border: none;">2</td>
                        <td style="border: none;">Technology</td>
                    </tr>
                    <tr style="background-color: #F2F2F2; border: none;">
                        <td style="border: none;">2</td>
                        <td style="border: none;">Technical Support</td>
                        <td style="border: none;">1</td>
                        <td style="border: none;">Content</td>
                    </tr>
                    <tr style="border: none;">
                        <td style="border: none;">3</td>
                        <td style="border: none;">Maintenance</td>
                        <td style="border: none;">3</td>
                        <td style="border: none;">File Upload</td>
                    </tr>
                    <tr style="background-color: #F2F2F2; border: none;">
                        <td style="border: none;">4</td>
                        <td style="border: none;">Processes</td>
                        <td style="border: none;">4</td>
                        <td style="border: none;">New User Registration</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

      
    <script>
        // Pie Chart for Distribution
        var distributionOptions = {
          series: [44, 55, 13, 43, 22],
          chart: {
            width: '100%',
            type: 'pie',
          },
          labels: ['Team A', 'Team B', 'Team C', 'Team D', 'Team E'],
          responsive: [{
            breakpoint: 480,
            options: {
              chart: {
                width: 200
              },
              legend: {
                position: 'bottom'
              }
            }
          }]
        };
    
        var distributionChart = new ApexCharts(document.querySelector("#distribution-chart"), distributionOptions);
        distributionChart.render();
    
        // Horizontal Bar Chart for Support Tickets
        var supportTicketsOptions = {
          series: [{
            data: [400, 430, 448, 470, 540, 580, 690, 1100, 1200, 1380]
          }],
          chart: {
            type: 'bar',
            height: 350
          },
          plotOptions: {
            bar: {
              borderRadius: 4,
              borderRadiusApplication: 'end',
              horizontal: true,
            }
          },
          dataLabels: {
            enabled: false
          },
          xaxis: {
            categories: ['South Korea', 'Canada', 'United Kingdom', 'Netherlands', 'Italy', 'France', 'Japan',
              'United States', 'China', 'Germany'
            ],
          }
        };
    
        var supportTicketsChart = new ApexCharts(document.querySelector("#support-tickets-chart"), supportTicketsOptions);
        supportTicketsChart.render();
    
        // Vertical Bar Chart for Users
        var colors = ['#008FFB', '#00E396', '#FEB019', '#FF4560', '#775DD0', '#546E7A', '#26A69A', '#D10CE8'];
    
        var usersOptions = {
          series: [{
            data: [21, 22, 10, 28, 16, 21, 13, 30]
          }],
          chart: {
            height: 350,
            type: 'bar',
            events: {
              click: function(chart, w, e) {
                // Add custom click logic here
              }
            }
          },
          colors: colors,
          plotOptions: {
            bar: {
              columnWidth: '45%',
              distributed: true,
            }
          },
          dataLabels: {
            enabled: false
          },
          legend: {
            show: false
          },
          xaxis: {
            categories: [
              ['John', 'Doe'],
              ['Joe', 'Smith'],
              ['Jake', 'Williams'],
              'Amber',
              ['Peter', 'Brown'],
              ['Mary', 'Evans'],
              ['David', 'Wilson'],
              ['Lily', 'Roberts'], 
            ],
            labels: {
              style: {
                colors: colors,
                fontSize: '12px'
              }
            }
          }
        };
    
        var usersChart = new ApexCharts(document.querySelector("#users-chart"), usersOptions);
        usersChart.render();
    
      </script>
    
  
 
{% endblock content %}